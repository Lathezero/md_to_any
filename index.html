<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Markdown转换成图片和HTML</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 0;
            height: 100vh;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80%;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
        }
        .output-container {
            display: flex;
            width: 100%;
            height: 60%;
            margin-top: 20px;
        }
        .output {
            flex: 1;
            border: 1px solid #ccc;
            padding: 10px;
            overflow: auto;
            box-sizing: border-box;
        }
        #htmlOutput {
            margin-right: 10px;
        }
        #outputImage {
            display: block;
            max-width: 100%;
            max-height: 100%;
        }
        #downloadLink {
            margin: 20px 0;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Markdown转换成图片和HTML</h1>
    <textarea id="markdownInput" placeholder="在这里输入Markdown内容"></textarea><br>
    <button onclick="convertToImage()">转换成图片和HTML</button><br>
    <a id="downloadLink" href="" download="output.docx" style="display:none;">下载Word文档</a>
    <div class="output-container">
        <div id="htmlOutput" class="output"></div>
        <div id="imageOutput" class="output">
            <img id="outputImage" src="" alt="转换后的图片">
        </div>
    </div>
</div>
<script>
    async function convertToImage() {
        const markdownContent = document.getElementById('markdownInput').value;

        // 向后端发送请求
        const response = await fetch('/convert', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ markdown: markdownContent })
        });

        const result = await response.json();

        // 显示转换后的HTML
        document.getElementById('htmlOutput').innerHTML = result.html;

        // 显示生成的图片
        const imageUrl = `data:image/png;base64,${result.image}`;
        const outputImage = document.getElementById('outputImage');
        outputImage.src = imageUrl;

        // 释放URL资源
        outputImage.onload = () => URL.revokeObjectURL(imageUrl);

        // 显示下载Word文档的链接
        const downloadLink = document.getElementById('downloadLink');
        downloadLink.href = result.wordUrl;
        downloadLink.style.display = 'block';
    }
</script>
</body>
</html>
